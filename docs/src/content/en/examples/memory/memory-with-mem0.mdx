---
title: "Example: Memory with Mem0 | Memory | Mastra Docs"
description: Example for how to use Mastra's agent system with Mem0 as the memory backend through custom tools.
---

# Memory with Mem0

This example demonstrates how to use Mastra's agent system with Mem0 as the memory backend through custom tools.

## Prerequisites

This example uses the `openai` model and requires a Mem0 API key. Make sure to add the following to your `.env` file:

```bash filename=".env" copy
OPENAI_API_KEY=<your-api-key>
MEM0_API_KEY=<your-mem0-api-key>
```

And install the following package:

```bash copy
npm install @mastra/mem0
```

You can get your Mem0 API key by signing up at [app.mem0.ai](https://app.mem0.ai) and creating a new project.

## Adding memory to an agent

To add Mem0 memory to an agent, create custom tools that use a `Mem0Integration` and add them to the agent's tools. This gives the agent control over memory operations using Mem0.

```typescript filename="src/mastra/agents/example-mem0-agent.ts" showLineNumbers copy
import { createTool } from "@mastra/core/tools";
import { Agent } from "@mastra/core/agent";
import { openai } from "@ai-sdk/openai";
import { Mem0Integration } from "@mastra/mem0";
import { z } from "zod";

const mem0 = new Mem0Integration({
  config: {
    apiKey: process.env.MEM0_API_KEY!,
    user_id: "mem0-agent"
  }
});

export const mem0Agent = new Agent({
  name: "mem0-agent",
  instructions: `
    You are a helpful assistant that has the ability to memorize and remember facts using Mem0.
    Use the Mem0-memorize tool to save important information that might be useful later.
    Use the Mem0-remember tool to recall previously saved information when answering questions.
  `,
  model: openai("gpt-4o"),
  tools: {
    mem0Memorize: createTool({
      id: "Mem0-memorize",
      description: "Save information to Mem0",
      inputSchema: z.object({
        statement: z.string()
      }),
      execute: async ({ context }) => {
        const { statement } = context;

        await mem0.createMemory(statement);
        console.log(`memory "${statement}" saved.\n`);

        return { success: true };
      }
    }),
    mem0Remember: createTool({
      id: "Mem0-remember",
      description: "Recall agent memories",
      inputSchema: z.object({
        question: z.string()
      }),
      outputSchema: z.object({
        answer: z.string()
      }),
      execute: async ({ context }) => {
        const { question } = context;
        const memory = await mem0.searchMemory(question);
        return { answer: memory };
      }
    })
  }
});
```

## Usage example

Use system messages to ensure the agent calls the appropriate Mem0 tools. For memorization, use a system message to instruct the agent to save information. For recall, use a system message to instruct the agent to search memories before answering.

```typescript filename="src/test-mem0-agent.ts" showLineNumbers copy
import "dotenv/config";

import { mastra } from "./mastra";

const threadId = "123";
const resourceId = "user-456";

const agent = mastra.getAgent("mem0Agent");

const message = await agent.stream(
  [
    { role: "system", content: "Use the mem0Memorize tool to save any personal information shared by the user." },
    { role: "user", content: "My name is Mastra" }
  ],
  {
    memory: { thread: threadId, resource: resourceId }
  }
);

await message.textStream.pipeTo(new WritableStream());

const stream = await agent.stream(
  [
    { role: "system", content: "Use the mem0Remember tool to search for any relevant memories before answering questions about the user." },
    { role: "user", content: "What's my name?" }
  ],
  {
    memory: {
      thread: threadId,
      resource: resourceId
    }
  }
);

for await (const chunk of stream.textStream) {
  process.stdout.write(chunk);
}
```

